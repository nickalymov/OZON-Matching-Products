# üß† OZON-Matching-Products
## ML-—Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ Ozon Tech: –ú–∞—Ç—á–∏–Ω–≥ —Ç–æ–≤–∞—Ä–æ–≤
–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏—è–º, –∞—Ç—Ä–∏–±—É—Ç–∞–º –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º. –†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ —Ä–∞–º–∫–∞—Ö —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è Ozon Tech –∏ –∑–∞–Ω—è–ª–∞ 7-–µ –º–µ—Å—Ç–æ –∏–∑ 110 –∫–æ–º–∞–Ω–¥ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º ROC-AUC = 0.9216.

## üöÄ –ó–∞–¥–∞—á–∞
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ –¥–∞–Ω–Ω—ã–º –æ –¥–≤—É—Ö —Ç–æ–≤–∞—Ä–∞—Ö (—Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∞—Ç—Ä–∏–±—É—Ç—ã) –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç, —è–≤–ª—è—é—Ç—Å—è –ª–∏ –æ–Ω–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ (target = 1) –∏–ª–∏ –Ω–µ—Ç (target = 0).

## üì¶ –î–∞–Ω–Ω—ã–µ
–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã:

train.csv ‚Äì –ø–∞—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤ —Å –º–µ—Ç–∫–æ–π (variantid1, variantid2, target)
test.csv ‚Äì –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –Ω–æ –±–µ–∑ –º–µ—Ç–æ–∫
attributes.csv ‚Äì –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –∞—Ç—Ä–∏–±—É—Ç—ã —Ç–æ–≤–∞—Ä–æ–≤
text.csv ‚Äì –Ω–∞–∑–≤–∞–Ω–∏—è, –æ–ø–∏—Å–∞–Ω–∏—è –∏ BERT-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏
resnet.csv ‚Äì ResNet-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤

## üîß –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç –±–∞–∑–æ–≤—É—é —á–∏—Å—Ç–∫—É –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ:
—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞, –ñ–∞–∫–∫–∞—Ä, –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫ –∏ –¥—Ä.)
–∫–∞—Ç–µ–≥–æ—Ä–∏–π (—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
–∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–ñ–∞–∫–∫–∞—Ä, —Ä–∞–∑–ª–∏—á–∏–µ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ, –±–∏–Ω–∞—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏)
—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ –∏ –µ–≤–∫–ª–∏–¥–æ–≤–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, —ç–Ω—Ç—Ä–æ–ø–∏—è)

–ë–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π —Å–º. –≤ –Ω–æ—É—Ç–±—É–∫–∞—Ö:
1_main_features.ipynb
2_add_cat_features.ipynb

## üß† –ú–æ–¥–µ–ª–∏
### 1. AutoGluon Tabular (0.9216)
–ú—É–ª—å—Ç–∏-–º–æ–¥–µ–ª—å–Ω—ã–π —Å—Ç–µ–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –ø—Ä–µ—Å–µ—Ç—ã:
best_quality ‚Äî –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
zeroshot ‚Äî –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤


üì∏ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏ –≤–Ω—É—Ç—Ä–∏ AutoGluon:
![image](https://github.com/user-attachments/assets/02dd26a5-79e8-48d6-b932-ed624a16e689)


### 2. HistGradientBoosting + Optuna (0.91)
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –Ω–∞ –±–∞–∑–µ HistGradientBoostingClassifier –∏–∑ sklearn, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —á–µ—Ä–µ–∑ Optuna.

–û—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
–ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

–§–∞–π–ª—ã:
training_hgb.ipynb ‚Äì –æ–±—É—á–µ–Ω–∏–µ –∏ –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
inference.ipynb ‚Äì –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –æ—Ç —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π

## üèÅ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
AutoGluon (stacked): ROC-AUC 0.9216 ‚Äì —Ç–æ–ø-7 –≤ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–µ
HistGradientBoosting + Optuna: –±—ã—Å—Ç—Ä–µ–µ, —á—É—Ç—å –Ω–∏–∂–µ –ø–æ –º–µ—Ç—Ä–∏–∫–µ, –Ω–æ —É–¥–æ–±–µ–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## üîç –ê–Ω–∞–ª–∏–∑
–†–µ—à–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ –≤—ã—Å–æ–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ —Å—á—ë—Ç —Å–∏–ª—å–Ω–æ–π —Ñ–∏—á–µ-–∏–Ω–∂–µ–Ω–µ—Ä–∏–∏ –∏ AutoML. –û–¥–Ω–∞–∫–æ –∫–æ–º–∞–Ω–¥—ã –≤—ã—à–µ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, BERT) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤, —á—Ç–æ –¥–∞–ª–æ –ø—Ä–∏—Ä–æ—Å—Ç –∫ –∫–∞—á–µ—Å—Ç–≤—É.
